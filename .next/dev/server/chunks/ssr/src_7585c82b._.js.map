{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/farm_hands/src/components/features/procurement/procurement-module.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useAuth } from '@/components/layout/auth-provider';\r\nimport { useMutation, useQuery } from '@tanstack/react-query';\r\nimport { useState } from 'react';\r\n\r\ntype ApiEnvelope<T> = {\r\n  success: boolean;\r\n  data?: T;\r\n  error?: { code: string; message: string };\r\n};\r\n\r\nasync function apiCall<T>(path: string, options?: RequestInit): Promise<T> {\r\n  const response = await fetch(path, {\r\n    ...options,\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...(options?.headers || {}),\r\n    },\r\n  });\r\n\r\n  const json = (await response.json()) as ApiEnvelope<T>;\r\n  if (!json.success) {\r\n    throw new Error(json.error?.message || 'Request failed');\r\n  }\r\n\r\n  return json.data as T;\r\n}\r\n\r\nexport function ProcurementModule() {\r\n  const { farmId } = useAuth();\r\n  const [requestReason, setRequestReason] = useState('');\r\n  const [requestAmount, setRequestAmount] = useState(0);\r\n  const [vendorId, setVendorId] = useState('');\r\n  const [itemDescription, setItemDescription] = useState('');\r\n  const [itemQty, setItemQty] = useState(1);\r\n  const [itemPrice, setItemPrice] = useState(0);\r\n  const [deliveryPoId, setDeliveryPoId] = useState('');\r\n  const [deliveryItemId, setDeliveryItemId] = useState('');\r\n  const [deliveryQty, setDeliveryQty] = useState(1);\r\n  const [discrepancyNote, setDiscrepancyNote] = useState('');\r\n\r\n  const ordersQuery = useQuery({\r\n    queryKey: ['procurement-orders', farmId],\r\n    queryFn: () => apiCall<any[]>(`/api/farms/${farmId}/procurement/orders`),\r\n    enabled: Boolean(farmId),\r\n  });\r\n\r\n  const requestPurchaseMutation = useMutation({\r\n    mutationFn: () => apiCall(`/api/farms/${farmId}/procurement/requests`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        reason: requestReason,\r\n        amount: requestAmount,\r\n        vendorId: vendorId || undefined,\r\n        idempotencyKey: crypto.randomUUID(),\r\n      }),\r\n    }),\r\n    onSuccess: () => {\r\n      setRequestReason('');\r\n      setRequestAmount(0);\r\n    },\r\n  });\r\n\r\n  const createOrderMutation = useMutation({\r\n    mutationFn: () => apiCall(`/api/farms/${farmId}/procurement/orders`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        vendorId,\r\n        idempotencyKey: crypto.randomUUID(),\r\n        items: [{ description: itemDescription, qty: itemQty, unitPrice: itemPrice }],\r\n      }),\r\n    }),\r\n    onSuccess: () => {\r\n      setItemDescription('');\r\n      setItemQty(1);\r\n      setItemPrice(0);\r\n      void ordersQuery.refetch();\r\n    },\r\n  });\r\n\r\n  const confirmDeliveryMutation = useMutation({\r\n    mutationFn: () => apiCall(`/api/farms/${farmId}/procurement/deliveries`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        poId: deliveryPoId,\r\n        idempotencyKey: crypto.randomUUID(),\r\n        discrepancyNote: discrepancyNote || undefined,\r\n        items: [{ itemId: deliveryItemId, qty: deliveryQty }],\r\n      }),\r\n    }),\r\n    onSuccess: () => {\r\n      setDiscrepancyNote('');\r\n      setDeliveryQty(1);\r\n      void ordersQuery.refetch();\r\n    },\r\n  });\r\n\r\n  return (\r\n    <div className=\"p-4 md:p-6 max-w-6xl mx-auto w-full space-y-6 pb-24 md:pb-8\">\r\n      <header>\r\n        <h1 className=\"text-2xl font-bold tracking-tight\">Procurement</h1>\r\n        <p className=\"text-xs text-muted-foreground uppercase font-semibold\">Requests, POs, delivery confirmation</p>\r\n      </header>\r\n\r\n      <section className=\"p-4 border rounded-xl bg-card space-y-3\">\r\n        <h2 className=\"text-sm font-bold uppercase\">Purchase Request</h2>\r\n        <input\r\n          value={requestReason}\r\n          onChange={(event) => setRequestReason(event.target.value)}\r\n          placeholder=\"Reason\"\r\n          className=\"w-full h-10 rounded-md bg-accent/50 px-3 text-sm\"\r\n        />\r\n        <input\r\n          type=\"number\"\r\n          value={requestAmount}\r\n          onChange={(event) => setRequestAmount(Number(event.target.value))}\r\n          placeholder=\"Amount\"\r\n          className=\"w-full h-10 rounded-md bg-accent/50 px-3 text-sm\"\r\n        />\r\n        <button\r\n          onClick={() => requestPurchaseMutation.mutate()}\r\n          disabled={requestPurchaseMutation.isPending || !requestReason || requestAmount <= 0}\r\n          className=\"w-full h-10 rounded-md bg-primary text-primary-foreground text-sm font-semibold disabled:opacity-50\"\r\n        >\r\n          {requestPurchaseMutation.isPending ? 'Submitting...' : 'Submit Request'}\r\n        </button>\r\n      </section>\r\n\r\n      <section className=\"p-4 border rounded-xl bg-card space-y-3\">\r\n        <h2 className=\"text-sm font-bold uppercase\">Create Purchase Order</h2>\r\n        <input\r\n          value={vendorId}\r\n          onChange={(event) => setVendorId(event.target.value)}\r\n          placeholder=\"Vendor ID\"\r\n          className=\"w-full h-10 rounded-md bg-accent/50 px-3 text-sm\"\r\n        />\r\n        <input\r\n          value={itemDescription}\r\n          onChange={(event) => setItemDescription(event.target.value)}\r\n          placeholder=\"Item description\"\r\n          className=\"w-full h-10 rounded-md bg-accent/50 px-3 text-sm\"\r\n        />\r\n        <div className=\"grid grid-cols-2 gap-2\">\r\n          <input\r\n            type=\"number\"\r\n            value={itemQty}\r\n            onChange={(event) => setItemQty(Number(event.target.value))}\r\n            placeholder=\"Qty\"\r\n            className=\"w-full h-10 rounded-md bg-accent/50 px-3 text-sm\"\r\n          />\r\n          <input\r\n            type=\"number\"\r\n            value={itemPrice}\r\n            onChange={(event) => setItemPrice(Number(event.target.value))}\r\n            placeholder=\"Unit price\"\r\n            className=\"w-full h-10 rounded-md bg-accent/50 px-3 text-sm\"\r\n          />\r\n        </div>\r\n        <button\r\n          onClick={() => createOrderMutation.mutate()}\r\n          disabled={createOrderMutation.isPending || !vendorId || !itemDescription || itemQty <= 0 || itemPrice <= 0}\r\n          className=\"w-full h-10 rounded-md bg-primary text-primary-foreground text-sm font-semibold disabled:opacity-50\"\r\n        >\r\n          {createOrderMutation.isPending ? 'Creating...' : 'Create PO'}\r\n        </button>\r\n      </section>\r\n\r\n      <section className=\"p-4 border rounded-xl bg-card space-y-3\">\r\n        <h2 className=\"text-sm font-bold uppercase\">Confirm Delivery</h2>\r\n        <input\r\n          value={deliveryPoId}\r\n          onChange={(event) => setDeliveryPoId(event.target.value)}\r\n          placeholder=\"PO ID\"\r\n          className=\"w-full h-10 rounded-md bg-accent/50 px-3 text-sm\"\r\n        />\r\n        <input\r\n          value={deliveryItemId}\r\n          onChange={(event) => setDeliveryItemId(event.target.value)}\r\n          placeholder=\"Inventory Item ID\"\r\n          className=\"w-full h-10 rounded-md bg-accent/50 px-3 text-sm\"\r\n        />\r\n        <input\r\n          type=\"number\"\r\n          value={deliveryQty}\r\n          onChange={(event) => setDeliveryQty(Number(event.target.value))}\r\n          placeholder=\"Delivered quantity\"\r\n          className=\"w-full h-10 rounded-md bg-accent/50 px-3 text-sm\"\r\n        />\r\n        <input\r\n          value={discrepancyNote}\r\n          onChange={(event) => setDiscrepancyNote(event.target.value)}\r\n          placeholder=\"Discrepancy note (optional)\"\r\n          className=\"w-full h-10 rounded-md bg-accent/50 px-3 text-sm\"\r\n        />\r\n        <button\r\n          onClick={() => confirmDeliveryMutation.mutate()}\r\n          disabled={confirmDeliveryMutation.isPending || !deliveryPoId || !deliveryItemId || deliveryQty <= 0}\r\n          className=\"w-full h-10 rounded-md bg-primary text-primary-foreground text-sm font-semibold disabled:opacity-50\"\r\n        >\r\n          {confirmDeliveryMutation.isPending ? 'Confirming...' : 'Confirm Delivery'}\r\n        </button>\r\n      </section>\r\n\r\n      <section className=\"p-4 border rounded-xl bg-card\">\r\n        <h2 className=\"text-sm font-bold uppercase mb-3\">Recent POs</h2>\r\n        <div className=\"space-y-2\">\r\n          {ordersQuery.data?.length ? ordersQuery.data.map((order: any) => (\r\n            <div key={order.id} className=\"p-2 rounded-md bg-accent/20 text-xs flex justify-between\">\r\n              <span className=\"font-medium\">{order.id.slice(0, 10)}</span>\r\n              <span className=\"uppercase text-muted-foreground\">{order.status}</span>\r\n            </div>\r\n          )) : <p className=\"text-xs text-muted-foreground\">No purchase orders yet.</p>}\r\n        </div>\r\n      </section>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["apiCall","path","options","response","fetch","headers","json","success","Error","error","message","data","ProcurementModule","farmId","requestReason","setRequestReason","requestAmount","setRequestAmount","vendorId","setVendorId","itemDescription","setItemDescription","itemQty","setItemQty","itemPrice","setItemPrice","deliveryPoId","setDeliveryPoId","deliveryItemId","setDeliveryItemId","deliveryQty","setDeliveryQty","discrepancyNote","setDiscrepancyNote","ordersQuery","queryKey","queryFn","enabled","Boolean","requestPurchaseMutation","mutationFn","method","body","JSON","stringify","reason","amount","undefined","idempotencyKey","crypto","randomUUID","onSuccess","createOrderMutation","items","description","qty","unitPrice","refetch","confirmDeliveryMutation","poId","itemId","className","value","onChange","event","target","placeholder","type","Number","onClick","mutate","disabled","isPending","length","map","order","id","slice","status"],"mappings":"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"}},
    {"offset": {"line": 398, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/farm_hands/src/app/%28dashboard%29/procurement/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { ProcurementModule } from '@/components/features/procurement/procurement-module';\r\n\r\nexport default function ProcurementPage() {\r\n  return <ProcurementModule />;\r\n}\r\n"],"names":["ProcurementPage"],"mappings":";;;;;AAEA;AAFA;;;AAIe,SAASA;IACtB,qBAAO,8OAAC,2LAAiB;;;;;AAC3B"}}]
}