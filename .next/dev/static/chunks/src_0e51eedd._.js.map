{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/farm_hands/src/components/features/tasks/task-lanes.ts"],"sourcesContent":["import type { LocalTask } from '@/lib/db';\r\n\r\nexport type TaskLanes = {\r\n  TODAY: LocalTask[];\r\n  OVERDUE: LocalTask[];\r\n  COMPLETED: LocalTask[];\r\n};\r\n\r\nexport function partitionTaskLanes(tasks: LocalTask[] | undefined, nowMs = Date.now()): TaskLanes {\r\n  const items = tasks ?? [];\r\n\r\n  return {\r\n    TODAY: items.filter((task) => task.status !== 'COMPLETED' && new Date(task.dueDate).getTime() >= nowMs),\r\n    OVERDUE: items.filter((task) => task.status !== 'COMPLETED' && new Date(task.dueDate).getTime() < nowMs),\r\n    COMPLETED: items.filter((task) => task.status === 'COMPLETED'),\r\n  };\r\n}\r\n"],"names":["partitionTaskLanes","tasks","nowMs","Date","now","items","TODAY","filter","task","status","dueDate","getTime","OVERDUE","COMPLETED"],"mappings":";;;;AAQO,SAASA,mBAAmBC,KAA8B,EAAEC,QAAQC,KAAKC,GAAG,EAAE;IACnF,MAAMC,QAAQJ,SAAS,EAAE;IAEzB,OAAO;QACLK,OAAOD,MAAME,MAAM,CAAC,CAACC,OAASA,KAAKC,MAAM,KAAK,eAAe,IAAIN,KAAKK,KAAKE,OAAO,EAAEC,OAAO,MAAMT;QACjGU,SAASP,MAAME,MAAM,CAAC,CAACC,OAASA,KAAKC,MAAM,KAAK,eAAe,IAAIN,KAAKK,KAAKE,OAAO,EAAEC,OAAO,KAAKT;QAClGW,WAAWR,MAAME,MAAM,CAAC,CAACC,OAASA,KAAKC,MAAM,KAAK;IACpD;AACF"}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/farm_hands/src/app/%28dashboard%29/tasks/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport Link from 'next/link';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { db } from '@/lib/db';\r\nimport { formatDate } from '@/lib/utils';\r\nimport { useEffect, useMemo, useState } from 'react';\r\nimport { useAuth } from '@/components/layout/auth-provider';\r\nimport { partitionTaskLanes } from '@/components/features/tasks/task-lanes';\r\n\r\nexport default function TaskBoard() {\r\n  const [activeLane, setActiveLane] = useState<'TODAY' | 'OVERDUE' | 'COMPLETED'>('TODAY');\r\n  const [templateName, setTemplateName] = useState('');\r\n  const [templateNotes, setTemplateNotes] = useState('');\r\n  const [templates, setTemplates] = useState<Array<{ id: string; name: string; notes?: string }>>([]);\r\n  const { farmId } = useAuth();\r\n\r\n  const { data: tasks, isLoading, refetch } = useQuery({\r\n    queryKey: ['local_tasks'],\r\n    queryFn: () => db.local_tasks.orderBy('dueDate').toArray(),\r\n  });\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n\r\n    const seedSampleTask = async () => {\r\n      const totalTasks = await db.local_tasks.count();\r\n      if (totalTasks > 0 || cancelled) return;\r\n\r\n      await db.local_tasks.add({\r\n        id: 'sample-task-1',\r\n        farmId: farmId || 'farm-123',\r\n        title: 'Inspect irrigation lines in Section A',\r\n        status: 'IN_PROGRESS',\r\n        dueDate: new Date(Date.now() + 2 * 60 * 60 * 1000),\r\n        assignedTo: 'field-worker-1',\r\n        data: {\r\n          priority: 'MEDIUM',\r\n          checklist: ['Check pressure', 'Look for leaks', 'Capture proof photo'],\r\n          notes: 'Verify all hose joints before 4 PM.',\r\n        },\r\n      });\r\n\r\n      await db.local_tasks.add({\r\n        id: 'sample-task-2',\r\n        farmId: farmId || 'farm-123',\r\n        title: 'Repair cracked drip connector at Zone B',\r\n        status: 'TODO',\r\n        dueDate: new Date(Date.now() - 90 * 60 * 1000),\r\n        assignedTo: 'field-worker-2',\r\n        data: {\r\n          priority: 'HIGH',\r\n          checklist: ['Replace connector', 'Pressure test line', 'Capture photo proof'],\r\n          notes: 'Escalated by monitoring alert #M-022.',\r\n        },\r\n      });\r\n\r\n      await db.local_tasks.add({\r\n        id: 'sample-task-3',\r\n        farmId: farmId || 'farm-123',\r\n        title: 'Close end-of-day feed storage checklist',\r\n        status: 'COMPLETED',\r\n        dueDate: new Date(Date.now() - 5 * 60 * 60 * 1000),\r\n        assignedTo: 'field-worker-3',\r\n        data: {\r\n          priority: 'LOW',\r\n          checklist: ['Count bags', 'Seal storage', 'Record notes'],\r\n        },\r\n      });\r\n\r\n      if (!cancelled) {\r\n        await refetch();\r\n      }\r\n    };\r\n\r\n    void seedSampleTask();\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [farmId, refetch]);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const stored = localStorage.getItem('farmops.taskTemplates');\r\n      if (!stored) return;\r\n      const parsed = JSON.parse(stored) as Array<{ id: string; name: string; notes?: string }>;\r\n      if (Array.isArray(parsed)) setTemplates(parsed);\r\n    } catch {\r\n      setTemplates([]);\r\n    }\r\n  }, []);\r\n\r\n  const persistTemplates = (nextTemplates: Array<{ id: string; name: string; notes?: string }>) => {\r\n    setTemplates(nextTemplates);\r\n    localStorage.setItem('farmops.taskTemplates', JSON.stringify(nextTemplates));\r\n  };\r\n\r\n  const now = Date.now();\r\n  const lanes = useMemo(() => partitionTaskLanes(tasks, now), [tasks, now]);\r\n\r\n  const visibleTasks = lanes[activeLane];\r\n\r\n  const addTemplate = () => {\r\n    if (templateName.trim().length < 2) return;\r\n    const next = [\r\n      ...templates,\r\n      {\r\n        id: crypto.randomUUID(),\r\n        name: templateName.trim(),\r\n        notes: templateNotes.trim() || undefined,\r\n      },\r\n    ];\r\n    persistTemplates(next);\r\n    setTemplateName('');\r\n    setTemplateNotes('');\r\n  };\r\n\r\n  const removeTemplate = (id: string) => {\r\n    persistTemplates(templates.filter((template) => template.id !== id));\r\n  };\r\n\r\n  const createTaskFromTemplate = async (templateId: string) => {\r\n    const template = templates.find((entry) => entry.id === templateId);\r\n    if (!template) return;\r\n\r\n    await db.local_tasks.add({\r\n      id: crypto.randomUUID(),\r\n      farmId: farmId || 'farm-123',\r\n      title: template.name,\r\n      status: 'TODO',\r\n      dueDate: new Date(Date.now() + 3 * 60 * 60 * 1000),\r\n      assignedTo: 'template-assignee',\r\n      data: {\r\n        priority: 'MEDIUM',\r\n        notes: template.notes,\r\n        source: 'template',\r\n      },\r\n    });\r\n    await refetch();\r\n  };\r\n\r\n  if (isLoading) return <div className=\"p-4 animate-pulse\">Loading tasks...</div>;\r\n\r\n  return (\r\n    <div className=\"p-4 md:p-6 max-w-6xl mx-auto w-full space-y-6\">\r\n      <header>\r\n        <h1 className=\"text-2xl font-bold\">Today's Work</h1>\r\n        <p className=\"text-muted-foreground text-sm\">Today, overdue, completed + reusable templates</p>\r\n      </header>\r\n\r\n      <section className=\"grid grid-cols-3 gap-2 rounded-xl border bg-card p-1\">\r\n        {([\r\n          { id: 'TODAY', label: 'Today' },\r\n          { id: 'OVERDUE', label: 'Overdue' },\r\n          { id: 'COMPLETED', label: 'Completed' },\r\n        ] as const).map((lane) => (\r\n          <button\r\n            key={lane.id}\r\n            onClick={() => setActiveLane(lane.id)}\r\n            className={`h-10 rounded-lg text-xs font-semibold ${activeLane === lane.id ? 'bg-primary text-primary-foreground' : 'text-muted-foreground'}`}\r\n          >\r\n            {lane.label}\r\n          </button>\r\n        ))}\r\n      </section>\r\n\r\n      <div className=\"space-y-4\">\r\n        {visibleTasks.length === 0 && (\r\n          <div className=\"text-center py-12 text-muted-foreground\">\r\n            No tasks in this lane.\r\n          </div>\r\n        )}\r\n\r\n        {visibleTasks.map((task) => (\r\n          <div \r\n            key={task.id}\r\n            className=\"p-4 border rounded-xl bg-card hover:border-primary/50 transition-colors shadow-sm\"\r\n          >\r\n            <div className=\"flex justify-between items-start\">\r\n              <div>\r\n                <h2 className=\"font-bold text-lg\">{task.title}</h2>\r\n                <time className=\"text-xs text-muted-foreground\">\r\n                  {formatDate(task.dueDate)}\r\n                </time>\r\n              </div>\r\n              <span className=\"px-2 py-1 text-[10px] font-bold rounded-full bg-accent uppercase\">\r\n                {task.status}\r\n              </span>\r\n            </div>\r\n\r\n            <div className=\"mt-4 flex gap-2\">\r\n              <Link href={`/tasks/${task.id}`} className=\"text-xs font-semibold underline underline-offset-4\">\r\n                Detailed Instructions\r\n              </Link>\r\n              <Link href={`/tasks/${task.id}`} className=\"ml-auto bg-primary text-primary-foreground px-4 py-1 rounded-md text-xs font-bold\">\r\n                Log Progress\r\n              </Link>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <section className=\"p-4 border rounded-xl bg-card space-y-3\">\r\n        <h2 className=\"text-sm font-bold uppercase\">Template Management</h2>\r\n        <input\r\n          value={templateName}\r\n          onChange={(event) => setTemplateName(event.target.value)}\r\n          className=\"w-full h-10 rounded-md bg-accent/50 px-3 text-sm\"\r\n          placeholder=\"Template name\"\r\n        />\r\n        <input\r\n          value={templateNotes}\r\n          onChange={(event) => setTemplateNotes(event.target.value)}\r\n          className=\"w-full h-10 rounded-md bg-accent/50 px-3 text-sm\"\r\n          placeholder=\"Template notes (optional)\"\r\n        />\r\n        <button\r\n          onClick={addTemplate}\r\n          disabled={templateName.trim().length < 2}\r\n          className=\"w-full h-10 rounded-md bg-secondary text-secondary-foreground text-sm font-semibold disabled:opacity-50\"\r\n        >\r\n          Save Template\r\n        </button>\r\n\r\n        <div className=\"space-y-2\">\r\n          {templates.length ? templates.map((template) => (\r\n            <div key={template.id} className=\"p-3 rounded-md bg-accent/20 space-y-2\">\r\n              <p className=\"text-sm font-semibold\">{template.name}</p>\r\n              {template.notes ? <p className=\"text-xs text-muted-foreground\">{template.notes}</p> : null}\r\n              <div className=\"flex gap-2\">\r\n                <button\r\n                  onClick={() => void createTaskFromTemplate(template.id)}\r\n                  className=\"h-8 px-3 rounded-md bg-primary text-primary-foreground text-xs font-semibold\"\r\n                >\r\n                  Use Template\r\n                </button>\r\n                <button\r\n                  onClick={() => removeTemplate(template.id)}\r\n                  className=\"h-8 px-3 rounded-md bg-secondary text-secondary-foreground text-xs font-semibold\"\r\n                >\r\n                  Delete\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )) : <p className=\"text-xs text-muted-foreground\">No templates yet.</p>}\r\n        </div>\r\n      </section>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["TaskBoard","activeLane","setActiveLane","templateName","setTemplateName","templateNotes","setTemplateNotes","templates","setTemplates","farmId","data","tasks","isLoading","refetch","queryKey","queryFn","local_tasks","orderBy","toArray","cancelled","seedSampleTask","totalTasks","count","add","id","title","status","dueDate","Date","now","assignedTo","priority","checklist","notes","stored","localStorage","getItem","parsed","JSON","parse","Array","isArray","persistTemplates","nextTemplates","setItem","stringify","lanes","visibleTasks","addTemplate","trim","length","next","crypto","randomUUID","name","undefined","removeTemplate","filter","template","createTaskFromTemplate","templateId","find","entry","source","className","label","map","lane","onClick","task","href","value","onChange","event","target","placeholder","disabled"],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AARA;;;;;;;;AAUe,SAASA;;IACtB,MAAM,CAACC,YAAYC,cAAc,GAAG,IAAA,yKAAQ,EAAoC;IAChF,MAAM,CAACC,cAAcC,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAACC,eAAeC,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAACC,WAAWC,aAAa,GAAG,IAAA,yKAAQ,EAAsD,EAAE;IAClG,MAAM,EAAEC,MAAM,EAAE,GAAG,IAAA,8JAAO;IAE1B,MAAM,EAAEC,MAAMC,KAAK,EAAEC,SAAS,EAAEC,OAAO,EAAE,GAAG,IAAA,0LAAQ,EAAC;QACnDC,UAAU;YAAC;SAAc;QACzBC,OAAO;kCAAE,IAAM,kIAAE,CAACC,WAAW,CAACC,OAAO,CAAC,WAAWC,OAAO;;IAC1D;IAEA,IAAA,0KAAS;+BAAC;YACR,IAAIC,YAAY;YAEhB,MAAMC;sDAAiB;oBACrB,MAAMC,aAAa,MAAM,kIAAE,CAACL,WAAW,CAACM,KAAK;oBAC7C,IAAID,aAAa,KAAKF,WAAW;oBAEjC,MAAM,kIAAE,CAACH,WAAW,CAACO,GAAG,CAAC;wBACvBC,IAAI;wBACJf,QAAQA,UAAU;wBAClBgB,OAAO;wBACPC,QAAQ;wBACRC,SAAS,IAAIC,KAAKA,KAAKC,GAAG,KAAK,IAAI,KAAK,KAAK;wBAC7CC,YAAY;wBACZpB,MAAM;4BACJqB,UAAU;4BACVC,WAAW;gCAAC;gCAAkB;gCAAkB;6BAAsB;4BACtEC,OAAO;wBACT;oBACF;oBAEA,MAAM,kIAAE,CAACjB,WAAW,CAACO,GAAG,CAAC;wBACvBC,IAAI;wBACJf,QAAQA,UAAU;wBAClBgB,OAAO;wBACPC,QAAQ;wBACRC,SAAS,IAAIC,KAAKA,KAAKC,GAAG,KAAK,KAAK,KAAK;wBACzCC,YAAY;wBACZpB,MAAM;4BACJqB,UAAU;4BACVC,WAAW;gCAAC;gCAAqB;gCAAsB;6BAAsB;4BAC7EC,OAAO;wBACT;oBACF;oBAEA,MAAM,kIAAE,CAACjB,WAAW,CAACO,GAAG,CAAC;wBACvBC,IAAI;wBACJf,QAAQA,UAAU;wBAClBgB,OAAO;wBACPC,QAAQ;wBACRC,SAAS,IAAIC,KAAKA,KAAKC,GAAG,KAAK,IAAI,KAAK,KAAK;wBAC7CC,YAAY;wBACZpB,MAAM;4BACJqB,UAAU;4BACVC,WAAW;gCAAC;gCAAc;gCAAgB;6BAAe;wBAC3D;oBACF;oBAEA,IAAI,CAACb,WAAW;wBACd,MAAMN;oBACR;gBACF;;YAEA,KAAKO;YACL;uCAAO;oBACLD,YAAY;gBACd;;QACF;8BAAG;QAACV;QAAQI;KAAQ;IAEpB,IAAA,0KAAS;+BAAC;YACR,IAAI;gBACF,MAAMqB,SAASC,aAAaC,OAAO,CAAC;gBACpC,IAAI,CAACF,QAAQ;gBACb,MAAMG,SAASC,KAAKC,KAAK,CAACL;gBAC1B,IAAIM,MAAMC,OAAO,CAACJ,SAAS7B,aAAa6B;YAC1C,EAAE,OAAM;gBACN7B,aAAa,EAAE;YACjB;QACF;8BAAG,EAAE;IAEL,MAAMkC,mBAAmB,CAACC;QACxBnC,aAAamC;QACbR,aAAaS,OAAO,CAAC,yBAAyBN,KAAKO,SAAS,CAACF;IAC/D;IAEA,MAAMd,MAAMD,KAAKC,GAAG;IACpB,MAAMiB,QAAQ,IAAA,wKAAO;oCAAC,IAAM,IAAA,gLAAkB,EAACnC,OAAOkB;mCAAM;QAAClB;QAAOkB;KAAI;IAExE,MAAMkB,eAAeD,KAAK,CAAC7C,WAAW;IAEtC,MAAM+C,cAAc;QAClB,IAAI7C,aAAa8C,IAAI,GAAGC,MAAM,GAAG,GAAG;QACpC,MAAMC,OAAO;eACR5C;YACH;gBACEiB,IAAI4B,OAAOC,UAAU;gBACrBC,MAAMnD,aAAa8C,IAAI;gBACvBhB,OAAO5B,cAAc4C,IAAI,MAAMM;YACjC;SACD;QACDb,iBAAiBS;QACjB/C,gBAAgB;QAChBE,iBAAiB;IACnB;IAEA,MAAMkD,iBAAiB,CAAChC;QACtBkB,iBAAiBnC,UAAUkD,MAAM,CAAC,CAACC,WAAaA,SAASlC,EAAE,KAAKA;IAClE;IAEA,MAAMmC,yBAAyB,OAAOC;QACpC,MAAMF,WAAWnD,UAAUsD,IAAI,CAAC,CAACC,QAAUA,MAAMtC,EAAE,KAAKoC;QACxD,IAAI,CAACF,UAAU;QAEf,MAAM,kIAAE,CAAC1C,WAAW,CAACO,GAAG,CAAC;YACvBC,IAAI4B,OAAOC,UAAU;YACrB5C,QAAQA,UAAU;YAClBgB,OAAOiC,SAASJ,IAAI;YACpB5B,QAAQ;YACRC,SAAS,IAAIC,KAAKA,KAAKC,GAAG,KAAK,IAAI,KAAK,KAAK;YAC7CC,YAAY;YACZpB,MAAM;gBACJqB,UAAU;gBACVE,OAAOyB,SAASzB,KAAK;gBACrB8B,QAAQ;YACV;QACF;QACA,MAAMlD;IACR;IAEA,IAAID,WAAW,qBAAO,6LAAC;QAAIoD,WAAU;kBAAoB;;;;;;IAEzD,qBACE,6LAAC;QAAIA,WAAU;;0BACb,6LAAC;;kCACC,6LAAC;wBAAGA,WAAU;kCAAqB;;;;;;kCACnC,6LAAC;wBAAEA,WAAU;kCAAgC;;;;;;;;;;;;0BAG/C,6LAAC;gBAAQA,WAAU;0BAChB,AAAC;oBACA;wBAAExC,IAAI;wBAASyC,OAAO;oBAAQ;oBAC9B;wBAAEzC,IAAI;wBAAWyC,OAAO;oBAAU;oBAClC;wBAAEzC,IAAI;wBAAayC,OAAO;oBAAY;iBACvC,CAAWC,GAAG,CAAC,CAACC,qBACf,6LAAC;wBAECC,SAAS,IAAMlE,cAAciE,KAAK3C,EAAE;wBACpCwC,WAAW,CAAC,sCAAsC,EAAE/D,eAAekE,KAAK3C,EAAE,GAAG,uCAAuC,yBAAyB;kCAE5I2C,KAAKF,KAAK;uBAJNE,KAAK3C,EAAE;;;;;;;;;;0BASlB,6LAAC;gBAAIwC,WAAU;;oBACZjB,aAAaG,MAAM,KAAK,mBACvB,6LAAC;wBAAIc,WAAU;kCAA0C;;;;;;oBAK1DjB,aAAamB,GAAG,CAAC,CAACG,qBACjB,6LAAC;4BAECL,WAAU;;8CAEV,6LAAC;oCAAIA,WAAU;;sDACb,6LAAC;;8DACC,6LAAC;oDAAGA,WAAU;8DAAqBK,KAAK5C,KAAK;;;;;;8DAC7C,6LAAC;oDAAKuC,WAAU;8DACb,IAAA,oIAAU,EAACK,KAAK1C,OAAO;;;;;;;;;;;;sDAG5B,6LAAC;4CAAKqC,WAAU;sDACbK,KAAK3C,MAAM;;;;;;;;;;;;8CAIhB,6LAAC;oCAAIsC,WAAU;;sDACb,6LAAC,0KAAI;4CAACM,MAAM,CAAC,OAAO,EAAED,KAAK7C,EAAE,EAAE;4CAAEwC,WAAU;sDAAqD;;;;;;sDAGhG,6LAAC,0KAAI;4CAACM,MAAM,CAAC,OAAO,EAAED,KAAK7C,EAAE,EAAE;4CAAEwC,WAAU;sDAAoF;;;;;;;;;;;;;2BAnB5HK,KAAK7C,EAAE;;;;;;;;;;;0BA2BlB,6LAAC;gBAAQwC,WAAU;;kCACjB,6LAAC;wBAAGA,WAAU;kCAA8B;;;;;;kCAC5C,6LAAC;wBACCO,OAAOpE;wBACPqE,UAAU,CAACC,QAAUrE,gBAAgBqE,MAAMC,MAAM,CAACH,KAAK;wBACvDP,WAAU;wBACVW,aAAY;;;;;;kCAEd,6LAAC;wBACCJ,OAAOlE;wBACPmE,UAAU,CAACC,QAAUnE,iBAAiBmE,MAAMC,MAAM,CAACH,KAAK;wBACxDP,WAAU;wBACVW,aAAY;;;;;;kCAEd,6LAAC;wBACCP,SAASpB;wBACT4B,UAAUzE,aAAa8C,IAAI,GAAGC,MAAM,GAAG;wBACvCc,WAAU;kCACX;;;;;;kCAID,6LAAC;wBAAIA,WAAU;kCACZzD,UAAU2C,MAAM,GAAG3C,UAAU2D,GAAG,CAAC,CAACR,yBACjC,6LAAC;gCAAsBM,WAAU;;kDAC/B,6LAAC;wCAAEA,WAAU;kDAAyBN,SAASJ,IAAI;;;;;;oCAClDI,SAASzB,KAAK,iBAAG,6LAAC;wCAAE+B,WAAU;kDAAiCN,SAASzB,KAAK;;;;;+CAAQ;kDACtF,6LAAC;wCAAI+B,WAAU;;0DACb,6LAAC;gDACCI,SAAS,IAAM,KAAKT,uBAAuBD,SAASlC,EAAE;gDACtDwC,WAAU;0DACX;;;;;;0DAGD,6LAAC;gDACCI,SAAS,IAAMZ,eAAeE,SAASlC,EAAE;gDACzCwC,WAAU;0DACX;;;;;;;;;;;;;+BAbKN,SAASlC,EAAE;;;;sDAkBlB,6LAAC;4BAAEwC,WAAU;sCAAgC;;;;;;;;;;;;;;;;;;;;;;;AAK5D;GA/OwBhE;;QAKH,8JAAO;QAEkB,0LAAQ;;;KAP9BA"}}]
}