{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/farm_hands/src/app/login/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from 'react';\r\nimport Link from 'next/link';\r\nimport { useRouter, useSearchParams } from 'next/navigation';\r\nimport { useAuth } from '@/components/layout/auth-provider';\r\n\r\nexport default function LoginPage() {\r\n  const router = useRouter();\r\n  const params = useSearchParams();\r\n  const { setFarmId, setRole, setRegistered } = useAuth();\r\n\r\n  const [email, setEmail] = useState(params.get('email') || '');\r\n  const [password, setPassword] = useState('');\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  const submit = async (event: React.FormEvent<HTMLFormElement>) => {\r\n    event.preventDefault();\r\n    setError('');\r\n\r\n    if (!email.trim() || !password.trim()) {\r\n      setError('Email and password are required.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsSubmitting(true);\r\n\r\n      const response = await fetch('/api/auth/login', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          email: email.trim(),\r\n          password,\r\n        }),\r\n      });\r\n\r\n      const contentType = response.headers.get('content-type') || '';\r\n      const result = contentType.includes('application/json')\r\n        ? await response.json()\r\n        : { success: false, error: { message: 'Server returned a non-JSON response. Check /api/auth/login route.' } };\r\n\r\n      if (!result.success) {\r\n        throw new Error(result.error?.message || 'Failed to sign in');\r\n      }\r\n\r\n      setRegistered(true);\r\n      setFarmId(result.data.farmId);\r\n      setRole(result.data.role);\r\n      router.push('/');\r\n    } catch (submitError) {\r\n      setError(submitError instanceof Error ? submitError.message : 'Failed to sign in');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-muted/30 px-4 py-10 md:py-16\">\r\n      <div className=\"mx-auto w-full max-w-md rounded-2xl border bg-card p-5 md:p-6 shadow-sm\">\r\n        <div className=\"mb-5 flex items-start gap-3\">\r\n          <div className=\"mt-1 h-9 w-9 rounded-md bg-primary text-primary-foreground flex items-center justify-center text-sm font-black\">\r\n            F\r\n          </div>\r\n          <div>\r\n            <h1 className=\"text-2xl font-black leading-none\">FarmOSP</h1>\r\n            <p className=\"text-sm text-muted-foreground mt-1\">Welcome back. Sign in to continue.</p>\r\n          </div>\r\n        </div>\r\n\r\n        <form className=\"space-y-3\" onSubmit={submit}>\r\n          <div className=\"space-y-1\">\r\n            <label htmlFor=\"email\" className=\"text-sm font-semibold\">Email</label>\r\n            <input\r\n              id=\"email\"\r\n              name=\"email\"\r\n              type=\"email\"\r\n              placeholder=\"name@example.com\"\r\n              value={email}\r\n              onChange={(event) => setEmail(event.target.value)}\r\n              className=\"h-11 w-full rounded-md border bg-background px-3 text-sm\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"space-y-1\">\r\n            <label htmlFor=\"password\" className=\"text-sm font-semibold\">Password</label>\r\n            <div className=\"relative\">\r\n              <input\r\n                id=\"password\"\r\n                name=\"password\"\r\n                type={showPassword ? 'text' : 'password'}\r\n                value={password}\r\n                onChange={(event) => setPassword(event.target.value)}\r\n                className=\"h-11 w-full rounded-md border bg-background px-3 pr-11 text-sm\"\r\n              />\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setShowPassword((current) => !current)}\r\n                className=\"absolute right-2 top-1/2 -translate-y-1/2 rounded px-2 py-1 text-xs text-muted-foreground\"\r\n              >\r\n                {showPassword ? 'Hide' : 'Show'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {error ? <p className=\"text-xs text-destructive\">{error}</p> : null}\r\n\r\n          <button\r\n            type=\"submit\"\r\n            disabled={isSubmitting}\r\n            className=\"mt-2 h-11 w-full rounded-md bg-primary text-sm font-semibold text-primary-foreground disabled:opacity-60\"\r\n          >\r\n            {isSubmitting ? 'Signing in...' : 'Sign In'}\r\n          </button>\r\n        </form>\r\n\r\n        <p className=\"mt-5 text-center text-sm text-muted-foreground\">\r\n          Don&apos;t have an account?{' '}\r\n          <Link href=\"/register\" className=\"font-semibold text-primary\">Create account</Link>\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["LoginPage","router","params","setFarmId","setRole","setRegistered","email","setEmail","get","password","setPassword","showPassword","setShowPassword","isSubmitting","setIsSubmitting","error","setError","submit","event","preventDefault","trim","response","fetch","method","headers","body","JSON","stringify","contentType","result","includes","json","success","message","Error","data","farmId","role","push","submitError","className","onSubmit","htmlFor","id","name","type","placeholder","value","onChange","target","onClick","current","disabled","href"],"mappings":"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"}}]
}