{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/farm_hands/src/components/layout/auth-provider.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { createContext, useContext, ReactNode, useEffect, useMemo, useState } from 'react';\r\n\r\ntype Role = 'OWNER' | 'MANAGER' | 'WORKER';\r\n\r\ninterface AuthContextType {\r\n  role: Role | null;\r\n  farmId: string | null;\r\n  isLoading: boolean;\r\n  isRegistered: boolean;\r\n  isAuthenticated: boolean;\r\n  setRole: (role: Role) => void;\r\n  setFarmId: (farmId: string) => void;\r\n  setRegistered: (registered: boolean) => void;\r\n  logout: () => void;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport function AuthProvider({ children }: { children: ReactNode }) {\r\n  const [role, setRoleState] = useState<Role | null>(null);\r\n  const [farmId, setFarmIdState] = useState<string | null>(null);\r\n  const [isRegistered, setIsRegistered] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const registered = localStorage.getItem('farmops.registered') === 'true';\r\n      const storedRole = localStorage.getItem('farmops.role');\r\n      const storedFarmId = localStorage.getItem('farmops.farmId');\r\n\r\n      setIsRegistered(registered);\r\n\r\n      if (!registered) {\r\n        localStorage.removeItem('farmops.role');\r\n        localStorage.removeItem('farmops.farmId');\r\n        return;\r\n      }\r\n\r\n      if (storedRole === 'OWNER' || storedRole === 'MANAGER' || storedRole === 'WORKER') {\r\n        setRoleState(storedRole);\r\n      }\r\n\r\n      if (storedFarmId && storedFarmId.trim().length > 0) {\r\n        setFarmIdState(storedFarmId);\r\n      }\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const setRole = (nextRole: Role) => {\r\n    setRoleState(nextRole);\r\n    localStorage.setItem('farmops.role', nextRole);\r\n  };\r\n\r\n  const setFarmId = (nextFarmId: string) => {\r\n    setFarmIdState(nextFarmId);\r\n    localStorage.setItem('farmops.farmId', nextFarmId);\r\n  };\r\n\r\n  const setRegistered = (registered: boolean) => {\r\n    setIsRegistered(registered);\r\n    localStorage.setItem('farmops.registered', registered ? 'true' : 'false');\r\n\r\n    if (!registered) {\r\n      setRoleState(null);\r\n      setFarmIdState(null);\r\n      localStorage.removeItem('farmops.role');\r\n      localStorage.removeItem('farmops.farmId');\r\n    }\r\n  };\r\n\r\n  const logout = () => {\r\n    setRoleState(null);\r\n    setFarmIdState(null);\r\n    localStorage.removeItem('farmops.role');\r\n    localStorage.removeItem('farmops.farmId');\r\n  };\r\n\r\n  const auth = useMemo(() => ({\r\n    role,\r\n    farmId,\r\n    isLoading,\r\n    isRegistered,\r\n    isAuthenticated: Boolean(role && farmId),\r\n    setRole,\r\n    setFarmId,\r\n    setRegistered,\r\n    logout,\r\n  }), [role, farmId, isLoading, isRegistered]);\r\n\r\n  return <AuthContext.Provider value={auth}>{children}</AuthContext.Provider>;\r\n}\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n}\r\n"],"names":["AuthContext","undefined","AuthProvider","children","role","setRoleState","farmId","setFarmIdState","isRegistered","setIsRegistered","isLoading","setIsLoading","registered","localStorage","getItem","storedRole","storedFarmId","removeItem","trim","length","setRole","nextRole","setItem","setFarmId","nextFarmId","setRegistered","logout","auth","isAuthenticated","Boolean","Provider","value","useAuth","context","Error"],"mappings":";;;;;;;AAEA;;;AAFA;;AAkBA,MAAMA,4BAAc,IAAA,8KAAa,EAA8BC;AAExD,SAASC,aAAa,EAAEC,QAAQ,EAA2B;;IAChE,MAAM,CAACC,MAAMC,aAAa,GAAG,IAAA,yKAAQ,EAAc;IACnD,MAAM,CAACC,QAAQC,eAAe,GAAG,IAAA,yKAAQ,EAAgB;IACzD,MAAM,CAACC,cAAcC,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAACC,WAAWC,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,IAAA,0KAAS;kCAAC;YACR,IAAI;gBACF,MAAMC,aAAaC,aAAaC,OAAO,CAAC,0BAA0B;gBAClE,MAAMC,aAAaF,aAAaC,OAAO,CAAC;gBACxC,MAAME,eAAeH,aAAaC,OAAO,CAAC;gBAE1CL,gBAAgBG;gBAEhB,IAAI,CAACA,YAAY;oBACfC,aAAaI,UAAU,CAAC;oBACxBJ,aAAaI,UAAU,CAAC;oBACxB;gBACF;gBAEA,IAAIF,eAAe,WAAWA,eAAe,aAAaA,eAAe,UAAU;oBACjFV,aAAaU;gBACf;gBAEA,IAAIC,gBAAgBA,aAAaE,IAAI,GAAGC,MAAM,GAAG,GAAG;oBAClDZ,eAAeS;gBACjB;YACF,SAAU;gBACRL,aAAa;YACf;QACF;iCAAG,EAAE;IAEL,MAAMS,UAAU,CAACC;QACfhB,aAAagB;QACbR,aAAaS,OAAO,CAAC,gBAAgBD;IACvC;IAEA,MAAME,YAAY,CAACC;QACjBjB,eAAeiB;QACfX,aAAaS,OAAO,CAAC,kBAAkBE;IACzC;IAEA,MAAMC,gBAAgB,CAACb;QACrBH,gBAAgBG;QAChBC,aAAaS,OAAO,CAAC,sBAAsBV,aAAa,SAAS;QAEjE,IAAI,CAACA,YAAY;YACfP,aAAa;YACbE,eAAe;YACfM,aAAaI,UAAU,CAAC;YACxBJ,aAAaI,UAAU,CAAC;QAC1B;IACF;IAEA,MAAMS,SAAS;QACbrB,aAAa;QACbE,eAAe;QACfM,aAAaI,UAAU,CAAC;QACxBJ,aAAaI,UAAU,CAAC;IAC1B;IAEA,MAAMU,OAAO,IAAA,wKAAO;sCAAC,IAAM,CAAC;gBAC1BvB;gBACAE;gBACAI;gBACAF;gBACAoB,iBAAiBC,QAAQzB,QAAQE;gBACjCc;gBACAG;gBACAE;gBACAC;YACF,CAAC;qCAAG;QAACtB;QAAME;QAAQI;QAAWF;KAAa;IAE3C,qBAAO,6LAACR,YAAY8B,QAAQ;QAACC,OAAOJ;kBAAOxB;;;;;;AAC7C;GA1EgBD;KAAAA;AA4ET,SAAS8B;;IACd,MAAMC,UAAU,IAAA,2KAAU,EAACjC;IAC3B,IAAIiC,YAAYhC,WAAW;QACzB,MAAM,IAAIiC,MAAM;IAClB;IACA,OAAOD;AACT;IANgBD"}},
    {"offset": {"line": 117, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/farm_hands/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from 'clsx';\r\nimport { twMerge } from 'tailwind-merge';\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs));\r\n}\r\n\r\nexport function formatDate(date: Date | string) {\r\n  return new Intl.DateTimeFormat('en-GB', {\r\n    day: 'numeric',\r\n    month: 'short',\r\n    year: '2-digit',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n  }).format(new Date(date));\r\n}\r\n"],"names":["cn","inputs","formatDate","date","Intl","DateTimeFormat","day","month","year","hour","minute","format","Date"],"mappings":";;;;;;AAAA;AACA;;;AAEO,SAASA,GAAG,GAAGC,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAACA;AACtB;AAEO,SAASC,WAAWC,IAAmB;IAC5C,OAAO,IAAIC,KAAKC,cAAc,CAAC,SAAS;QACtCC,KAAK;QACLC,OAAO;QACPC,MAAM;QACNC,MAAM;QACNC,QAAQ;IACV,GAAGC,MAAM,CAAC,IAAIC,KAAKT;AACrB"}},
    {"offset": {"line": 146, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/farm_hands/src/lib/db/index.ts"],"sourcesContent":["import Dexie, { type Table } from 'dexie';\r\n\r\nexport interface OutboxEntry {\r\n  id: string;\r\n  domain: string;\r\n  action: string;\r\n  payload: any;\r\n  status: 'PENDING' | 'SYNCING' | 'FAILED' | 'COMPLETED';\r\n  retryCount: number;\r\n  lastError?: string;\r\n  createdAt: Date;\r\n  nextAttemptAt?: Date;\r\n}\r\n\r\nexport interface LocalTask {\r\n  id: string;\r\n  farmId: string;\r\n  title: string;\r\n  status: 'TODO' | 'IN_PROGRESS' | 'COMPLETED' | 'VERIFIED';\r\n  dueDate: Date;\r\n  assignedTo?: string;\r\n  data: any;\r\n}\r\n\r\nexport class FarmDB extends Dexie {\r\n  outbox!: Table<OutboxEntry>;\r\n  local_tasks!: Table<LocalTask>;\r\n  local_media!: Table<{ id: string; blob: Blob; metadata: any; synced: boolean }>;\r\n  sync_meta!: Table<{ key: string; value: any }>;\r\n\r\n  constructor() {\r\n    super('FarmOpsDB');\r\n    this.version(1).stores({\r\n      outbox: 'id, domain, status, createdAt',\r\n      local_tasks: 'id, farmId, status, dueDate',\r\n      local_media: 'id, synced',\r\n      sync_meta: 'key'\r\n    });\r\n  }\r\n}\r\n\r\nexport const db = new FarmDB();\r\n"],"names":["FarmDB","outbox","local_tasks","local_media","sync_meta","version","stores","db"],"mappings":";;;;;;AAAA;;AAwBO,MAAMA,eAAe,yJAAK;IAC/BC,OAA4B;IAC5BC,YAA+B;IAC/BC,YAAgF;IAChFC,UAA+C;IAE/CJ,aAAc;QACZ,KAAK,CAAC;QACN,IAAI,CAACK,OAAO,CAAC,GAAGC,MAAM,CAAC;YACrBL,QAAQ;YACRC,aAAa;YACbC,aAAa;YACbC,WAAW;QACb;IACF;AACF;AAEO,MAAMG,KAAK,IAAIP"}},
    {"offset": {"line": 177, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/farm_hands/src/lib/store/outbox.ts"],"sourcesContent":["import { create } from 'zustand';\r\n\r\ninterface OutboxState {\r\n  isSyncing: boolean;\r\n  pendingCount: number;\r\n  setSyncing: (status: boolean) => void;\r\n  setPendingCount: (count: number) => void;\r\n}\r\n\r\nexport const useOutboxStore = create<OutboxState>((set) => ({\r\n  isSyncing: false,\r\n  pendingCount: 0,\r\n  setSyncing: (status) => set({ isSyncing: status }),\r\n  setPendingCount: (count) => set({ pendingCount: count }),\r\n}));\r\n"],"names":["useOutboxStore","set","isSyncing","pendingCount","setSyncing","status","setPendingCount","count"],"mappings":";;;;AAAA;;AASO,MAAMA,iBAAiB,IAAA,qJAAM,EAAc,CAACC,MAAQ,CAAC;QAC1DC,WAAW;QACXC,cAAc;QACdC,YAAY,CAACC,SAAWJ,IAAI;gBAAEC,WAAWG;YAAO;QAChDC,iBAAiB,CAACC,QAAUN,IAAI;gBAAEE,cAAcI;YAAM;IACxD,CAAC"}},
    {"offset": {"line": 200, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/farm_hands/src/hooks/outbox-transitions.ts"],"sourcesContent":["import type { OutboxEntry } from '@/lib/db';\r\n\r\nexport function toCompletedUpdate() {\r\n  return { status: 'COMPLETED' as const };\r\n}\r\n\r\nexport function toFailedUpdate(entry: OutboxEntry, error: unknown) {\r\n  return {\r\n    status: 'FAILED' as const,\r\n    retryCount: entry.retryCount + 1,\r\n    lastError: error instanceof Error ? error.message : 'Unknown error',\r\n  };\r\n}\r\n\r\nexport function toRetryUpdate() {\r\n  return {\r\n    status: 'PENDING' as const,\r\n    retryCount: 0,\r\n    lastError: undefined,\r\n    nextAttemptAt: new Date(),\r\n  };\r\n}\r\n"],"names":["toCompletedUpdate","status","toFailedUpdate","entry","error","retryCount","lastError","Error","message","toRetryUpdate","undefined","nextAttemptAt","Date"],"mappings":";;;;;;;;AAEO,SAASA;IACd,OAAO;QAAEC,QAAQ;IAAqB;AACxC;AAEO,SAASC,eAAeC,KAAkB,EAAEC,KAAc;IAC/D,OAAO;QACLH,QAAQ;QACRI,YAAYF,MAAME,UAAU,GAAG;QAC/BC,WAAWF,iBAAiBG,QAAQH,MAAMI,OAAO,GAAG;IACtD;AACF;AAEO,SAASC;IACd,OAAO;QACLR,QAAQ;QACRI,YAAY;QACZC,WAAWI;QACXC,eAAe,IAAIC;IACrB;AACF"}},
    {"offset": {"line": 235, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/farm_hands/src/hooks/use-offline-sync.ts"],"sourcesContent":["import { useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { db, OutboxEntry } from '@/lib/db';\r\nimport { useOutboxStore } from '@/lib/store/outbox';\r\nimport { useCallback, useEffect } from 'react';\r\nimport { toCompletedUpdate, toFailedUpdate } from './outbox-transitions';\r\n\r\nexport function useOfflineAction<T>(domain: string, action: string) {\r\n  const queryClient = useQueryClient();\r\n  const setPendingCount = useOutboxStore((state) => state.setPendingCount);\r\n\r\n  return useMutation({\r\n    mutationFn: async (payload: T) => {\r\n      const taskId = (payload as { taskId?: string })?.taskId;\r\n      if (typeof taskId === 'string' && taskId.length > 0) {\r\n        const existing = await db.outbox\r\n          .where('status')\r\n          .anyOf(['PENDING', 'FAILED', 'SYNCING'])\r\n          .filter((entry) => (\r\n            entry.domain === domain\r\n            && entry.action === action\r\n            && (entry.payload as { taskId?: string } | undefined)?.taskId === taskId\r\n          ))\r\n          .first();\r\n\r\n        if (existing) {\r\n          await db.outbox.update(existing.id, {\r\n            payload,\r\n            status: 'PENDING',\r\n            retryCount: 0,\r\n            lastError: undefined,\r\n            createdAt: new Date(),\r\n          });\r\n\r\n          const count = await db.outbox.where('status').equals('PENDING').count();\r\n          setPendingCount(count);\r\n          return { ...existing, payload, status: 'PENDING', retryCount: 0, lastError: undefined } as OutboxEntry;\r\n        }\r\n      }\r\n\r\n      const entry: OutboxEntry = {\r\n        id: crypto.randomUUID(),\r\n        domain,\r\n        action,\r\n        payload,\r\n        status: 'PENDING',\r\n        retryCount: 0,\r\n        createdAt: new Date(),\r\n      };\r\n\r\n      await db.outbox.add(entry);\r\n      \r\n      const count = await db.outbox.where('status').equals('PENDING').count();\r\n      setPendingCount(count);\r\n\r\n      // Attempt immediate sync if online\r\n      if (typeof window !== 'undefined' && navigator.onLine) {\r\n        // In a real app, you'd trigger the sync orchestrator here\r\n        console.log('Online: Triggering sync for', entry.id);\r\n      }\r\n\r\n      return entry;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: [domain] });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useSyncOrchestrator({ autoStart = true }: { autoStart?: boolean } = {}) {\r\n  const setPendingCount = useOutboxStore((state) => state.setPendingCount);\r\n  const setSyncing = useOutboxStore((state) => state.setSyncing);\r\n\r\n  const runSync = useCallback(async () => {\r\n    if (useOutboxStore.getState().isSyncing) {\r\n      return;\r\n    }\r\n\r\n    const pending = await db.outbox\r\n      .where('status')\r\n      .anyOf(['PENDING', 'FAILED'])\r\n      .toArray();\r\n\r\n    if (pending.length === 0) {\r\n      const count = await db.outbox.where('status').equals('PENDING').count();\r\n      setPendingCount(count);\r\n      return;\r\n    }\r\n\r\n    setSyncing(true);\r\n\r\n    try {\r\n      for (const item of pending) {\r\n        try {\r\n          await db.outbox.update(item.id, { status: 'SYNCING' });\r\n\r\n          // Implement exponential backoff check here logic\r\n          // await apiClient.processEvent(item);\r\n          await db.outbox.update(item.id, toCompletedUpdate());\r\n        } catch (error) {\r\n          await db.outbox.update(item.id, toFailedUpdate(item, error));\r\n        }\r\n      }\r\n\r\n      const count = await db.outbox.where('status').equals('PENDING').count();\r\n      setPendingCount(count);\r\n    } finally {\r\n      setSyncing(false);\r\n    }\r\n  }, [setPendingCount, setSyncing]);\r\n\r\n  useEffect(() => {\r\n    if (!autoStart) return;\r\n    if (typeof window === 'undefined') return;\r\n\r\n    window.addEventListener('online', runSync);\r\n    return () => window.removeEventListener('online', runSync);\r\n  }, [autoStart, runSync]);\r\n\r\n  return { runSync };\r\n}\r\n"],"names":["useOfflineAction","domain","action","queryClient","setPendingCount","state","mutationFn","payload","taskId","length","existing","outbox","where","anyOf","filter","entry","first","update","id","status","retryCount","lastError","undefined","createdAt","Date","count","equals","crypto","randomUUID","add","navigator","onLine","console","log","onSuccess","invalidateQueries","queryKey","useSyncOrchestrator","autoStart","setSyncing","runSync","getState","isSyncing","pending","toArray","item","error","window","addEventListener","removeEventListener"],"mappings":"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"}},
    {"offset": {"line": 405, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/farm_hands/src/app/providers.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\r\nimport { ReactNode, createContext, useContext, useEffect, useMemo, useState } from 'react';\r\nimport { useSyncOrchestrator } from '@/hooks/use-offline-sync';\r\n\r\ntype Theme = 'light' | 'dark';\r\ntype ThemeMode = Theme;\r\n\r\ntype ThemeContextValue = {\r\n  theme: Theme;\r\n  mode: ThemeMode;\r\n  setThemeMode: (mode: ThemeMode) => void;\r\n  cycleThemeMode: () => void;\r\n};\r\n\r\nconst ThemeContext = createContext<ThemeContextValue | undefined>(undefined);\r\n\r\nfunction getInitialThemeMode(): ThemeMode {\r\n  if (typeof window === 'undefined') return 'light';\r\n\r\n  const stored = window.localStorage.getItem('theme');\r\n  if (stored === 'light' || stored === 'dark') return stored;\r\n\r\n  return 'light';\r\n}\r\n\r\nfunction applyTheme(theme: Theme) {\r\n  if (typeof document === 'undefined') return;\r\n  document.documentElement.classList.toggle('dark', theme === 'dark');\r\n  document.documentElement.style.colorScheme = theme;\r\n}\r\n\r\nexport function Providers({ children }: { children: ReactNode }) {\r\n  const [queryClient] = useState(() => new QueryClient({\r\n    defaultOptions: {\r\n      queries: {\r\n        staleTime: 1000 * 60 * 5, // 5 minutes\r\n      },\r\n    },\r\n  }));\r\n  const [mode, setMode] = useState<ThemeMode>('light');\r\n  const [theme, setTheme] = useState<Theme>('light');\r\n\r\n  useSyncOrchestrator();\r\n\r\n  useEffect(() => {\r\n    const initialMode = getInitialThemeMode();\r\n    setMode(initialMode);\r\n    setTheme(initialMode);\r\n    applyTheme(initialMode);\r\n  }, []);\r\n\r\n  const setThemeMode = (nextMode: ThemeMode) => {\r\n    setMode(nextMode);\r\n    setTheme(nextMode);\r\n    if (typeof window !== 'undefined') {\r\n      window.localStorage.setItem('theme', nextMode);\r\n    }\r\n    applyTheme(nextMode);\r\n  };\r\n\r\n  const value = useMemo<ThemeContextValue>(() => ({\r\n    theme,\r\n    mode,\r\n    setThemeMode,\r\n    cycleThemeMode: () => {\r\n      const order: ThemeMode[] = ['light', 'dark'];\r\n      const next = order[(order.indexOf(mode) + 1) % order.length];\r\n      setThemeMode(next);\r\n    },\r\n  }), [theme, mode]);\r\n\r\n  return (\r\n    <ThemeContext.Provider value={value}>\r\n      <QueryClientProvider client={queryClient}>\r\n        {children}\r\n      </QueryClientProvider>\r\n    </ThemeContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useTheme() {\r\n  const context = useContext(ThemeContext);\r\n  if (!context) {\r\n    throw new Error('useTheme must be used within Providers');\r\n  }\r\n  return context;\r\n}\r\n"],"names":["ThemeContext","undefined","getInitialThemeMode","stored","window","localStorage","getItem","applyTheme","theme","document","documentElement","classList","toggle","style","colorScheme","Providers","children","queryClient","defaultOptions","queries","staleTime","mode","setMode","setTheme","initialMode","setThemeMode","nextMode","setItem","value","cycleThemeMode","order","next","indexOf","length","Provider","client","useTheme","context","Error"],"mappings":";;;;;;;AAEA;AAAA;AACA;AACA;;;AAJA;;;;AAgBA,MAAMA,6BAAe,IAAA,8KAAa,EAAgCC;AAElE,SAASC;IACP;;IAEA,MAAMC,SAASC,OAAOC,YAAY,CAACC,OAAO,CAAC;IAC3C,IAAIH,WAAW,WAAWA,WAAW,QAAQ,OAAOA;IAEpD,OAAO;AACT;AAEA,SAASI,WAAWC,KAAY;IAC9B,IAAI,OAAOC,aAAa,aAAa;IACrCA,SAASC,eAAe,CAACC,SAAS,CAACC,MAAM,CAAC,QAAQJ,UAAU;IAC5DC,SAASC,eAAe,CAACG,KAAK,CAACC,WAAW,GAAGN;AAC/C;AAEO,SAASO,UAAU,EAAEC,QAAQ,EAA2B;;IAC7D,MAAM,CAACC,YAAY,GAAG,IAAA,yKAAQ;8BAAC,IAAM,IAAI,+LAAW,CAAC;gBACnDC,gBAAgB;oBACdC,SAAS;wBACPC,WAAW,OAAO,KAAK;oBACzB;gBACF;YACF;;IACA,MAAM,CAACC,MAAMC,QAAQ,GAAG,IAAA,yKAAQ,EAAY;IAC5C,MAAM,CAACd,OAAOe,SAAS,GAAG,IAAA,yKAAQ,EAAQ;IAE1C,IAAA,gKAAmB;IAEnB,IAAA,0KAAS;+BAAC;YACR,MAAMC,cAActB;YACpBoB,QAAQE;YACRD,SAASC;YACTjB,WAAWiB;QACb;8BAAG,EAAE;IAEL,MAAMC,eAAe,CAACC;QACpBJ,QAAQI;QACRH,SAASG;QACT,wCAAmC;YACjCtB,OAAOC,YAAY,CAACsB,OAAO,CAAC,SAASD;QACvC;QACAnB,WAAWmB;IACb;IAEA,MAAME,QAAQ,IAAA,wKAAO;oCAAoB,IAAM,CAAC;gBAC9CpB;gBACAa;gBACAI;gBACAI,cAAc;gDAAE;wBACd,MAAMC,QAAqB;4BAAC;4BAAS;yBAAO;wBAC5C,MAAMC,OAAOD,KAAK,CAAC,CAACA,MAAME,OAAO,CAACX,QAAQ,CAAC,IAAIS,MAAMG,MAAM,CAAC;wBAC5DR,aAAaM;oBACf;;YACF,CAAC;mCAAG;QAACvB;QAAOa;KAAK;IAEjB,qBACE,6LAACrB,aAAakC,QAAQ;QAACN,OAAOA;kBAC5B,cAAA,6LAAC,gNAAmB;YAACO,QAAQlB;sBAC1BD;;;;;;;;;;;AAIT;GA/CgBD;;QAWd,gKAAmB;;;KAXLA;AAiDT,SAASqB;;IACd,MAAMC,UAAU,IAAA,2KAAU,EAACrC;IAC3B,IAAI,CAACqC,SAAS;QACZ,MAAM,IAAIC,MAAM;IAClB;IACA,OAAOD;AACT;IANgBD"}},
    {"offset": {"line": 525, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/farm_hands/src/components/layout/route-access.ts"],"sourcesContent":["export type RouteRule = { prefix: string; roles: string[] };\r\n\r\nexport const ROUTE_RULES: RouteRule[] = [\r\n  { prefix: '/tasks', roles: ['MANAGER', 'WORKER'] },\r\n  { prefix: '/finance', roles: ['OWNER', 'MANAGER'] },\r\n  { prefix: '/inventory', roles: ['OWNER', 'MANAGER'] },\r\n  { prefix: '/procurement', roles: ['OWNER', 'MANAGER'] },\r\n  { prefix: '/payroll', roles: ['OWNER', 'MANAGER'] },\r\n  { prefix: '/digest', roles: ['OWNER', 'MANAGER'] },\r\n  { prefix: '/monitoring', roles: ['OWNER', 'MANAGER'] },\r\n  { prefix: '/audits', roles: ['OWNER', 'MANAGER'] },\r\n  { prefix: '/vendor', roles: ['OWNER', 'MANAGER'] },\r\n  { prefix: '/updates/daily', roles: ['OWNER', 'MANAGER'] },\r\n  { prefix: '/updates', roles: ['OWNER', 'MANAGER', 'WORKER'] },\r\n  { prefix: '/incidents', roles: ['OWNER', 'MANAGER', 'WORKER'] },\r\n  { prefix: '/offline', roles: ['OWNER', 'MANAGER', 'WORKER'] },\r\n];\r\n\r\nexport function hasRouteAccess(pathname: string, role: string | null | undefined, rules: RouteRule[] = ROUTE_RULES) {\r\n  const matchedRule = rules.find((rule) => pathname.startsWith(rule.prefix));\r\n  return !matchedRule || matchedRule.roles.includes(role || '');\r\n}\r\n"],"names":["ROUTE_RULES","prefix","roles","hasRouteAccess","pathname","role","rules","matchedRule","find","rule","startsWith","includes"],"mappings":";;;;;;AAEO,MAAMA,cAA2B;IACtC;QAAEC,QAAQ;QAAUC,OAAO;YAAC;YAAW;SAAS;IAAC;IACjD;QAAED,QAAQ;QAAYC,OAAO;YAAC;YAAS;SAAU;IAAC;IAClD;QAAED,QAAQ;QAAcC,OAAO;YAAC;YAAS;SAAU;IAAC;IACpD;QAAED,QAAQ;QAAgBC,OAAO;YAAC;YAAS;SAAU;IAAC;IACtD;QAAED,QAAQ;QAAYC,OAAO;YAAC;YAAS;SAAU;IAAC;IAClD;QAAED,QAAQ;QAAWC,OAAO;YAAC;YAAS;SAAU;IAAC;IACjD;QAAED,QAAQ;QAAeC,OAAO;YAAC;YAAS;SAAU;IAAC;IACrD;QAAED,QAAQ;QAAWC,OAAO;YAAC;YAAS;SAAU;IAAC;IACjD;QAAED,QAAQ;QAAWC,OAAO;YAAC;YAAS;SAAU;IAAC;IACjD;QAAED,QAAQ;QAAkBC,OAAO;YAAC;YAAS;SAAU;IAAC;IACxD;QAAED,QAAQ;QAAYC,OAAO;YAAC;YAAS;YAAW;SAAS;IAAC;IAC5D;QAAED,QAAQ;QAAcC,OAAO;YAAC;YAAS;YAAW;SAAS;IAAC;IAC9D;QAAED,QAAQ;QAAYC,OAAO;YAAC;YAAS;YAAW;SAAS;IAAC;CAC7D;AAEM,SAASC,eAAeC,QAAgB,EAAEC,IAA+B,EAAEC,QAAqBN,WAAW;IAChH,MAAMO,cAAcD,MAAME,IAAI,CAAC,CAACC,OAASL,SAASM,UAAU,CAACD,KAAKR,MAAM;IACxE,OAAO,CAACM,eAAeA,YAAYL,KAAK,CAACS,QAAQ,CAACN,QAAQ;AAC5D"}},
    {"offset": {"line": 638, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/farm_hands/src/components/layout/navigation-shell.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useAuth } from './auth-provider';\r\nimport Link from 'next/link';\r\nimport { usePathname, useRouter } from 'next/navigation';\r\nimport { cn } from '@/lib/utils';\r\nimport { useTheme } from '@/app/providers';\r\nimport { db } from '@/lib/db';\r\nimport { hasRouteAccess, ROUTE_RULES } from './route-access';\r\nimport { \r\n  HomeIcon, \r\n  CheckCircleIcon, \r\n  BanknotesIcon, \r\n  ClipboardDocumentCheckIcon,\r\n  SignalIcon,\r\n  ShoppingCartIcon,\r\n  CreditCardIcon,\r\n  CalendarDaysIcon,\r\n  ChartBarIcon,\r\n  BellAlertIcon,\r\n  BuildingStorefrontIcon\r\n} from '@heroicons/react/24/outline';\r\nimport { useOutboxStore } from '@/lib/store/outbox';\r\n\r\nexport function NavigationShell({ children }: { children: React.ReactNode }) {\r\n  const { role, setRole, isLoading, isAuthenticated, isRegistered, logout } = useAuth();\r\n  const { mode, setThemeMode } = useTheme();\r\n  const [controlsOpen, setControlsOpen] = useState(false);\r\n  const router = useRouter();\r\n  const pathname = usePathname();\r\n  const pendingCount = useOutboxStore((state) => state.pendingCount);\r\n  const setPendingCount = useOutboxStore((state) => state.setPendingCount);\r\n  const isStandaloneRoute = pathname === '/register' || pathname === '/login';\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      await fetch('/api/auth/logout', { method: 'POST' });\r\n    } catch {\r\n    }\r\n\r\n    logout();\r\n    setControlsOpen(false);\r\n    router.replace('/login');\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isLoading) return;\r\n\r\n    if (!isAuthenticated) {\r\n      if (isStandaloneRoute) {\r\n        return;\r\n      }\r\n\r\n      const target = isRegistered ? '/login' : '/register';\r\n      if (pathname !== target) {\r\n        router.replace(target);\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (isAuthenticated && isStandaloneRoute) {\r\n      router.replace('/');\r\n    }\r\n  }, [isAuthenticated, isLoading, isRegistered, isStandaloneRoute, pathname, router]);\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n\r\n    const refreshPendingCount = async () => {\r\n      const count = await db.outbox.where('status').equals('PENDING').count();\r\n      if (!cancelled) {\r\n        setPendingCount(count);\r\n      }\r\n    };\r\n\r\n    void refreshPendingCount();\r\n    const interval = window.setInterval(() => {\r\n      void refreshPendingCount();\r\n    }, 3000);\r\n\r\n    return () => {\r\n      cancelled = true;\r\n      window.clearInterval(interval);\r\n    };\r\n  }, [setPendingCount]);\r\n\r\n  const navItems = [\r\n    { name: 'Home', href: '/', icon: HomeIcon, roles: ['OWNER', 'MANAGER', 'WORKER'] },\r\n    { name: 'Tasks', href: '/tasks', icon: CheckCircleIcon, roles: ['MANAGER', 'WORKER'] },\r\n    { name: 'Finance', href: '/finance', icon: BanknotesIcon, roles: ['OWNER', 'MANAGER'] },\r\n    { name: 'Updates', href: '/updates', icon: CalendarDaysIcon, roles: ['OWNER', 'MANAGER', 'WORKER'] },\r\n    { name: 'Digest', href: '/digest', icon: ChartBarIcon, roles: ['OWNER', 'MANAGER'] },\r\n    { name: 'Procure', href: '/procurement', icon: ShoppingCartIcon, roles: ['OWNER', 'MANAGER'] },\r\n    { name: 'Payroll', href: '/payroll', icon: CreditCardIcon, roles: ['OWNER', 'MANAGER'] },\r\n    { name: 'Monitor', href: '/monitoring', icon: BellAlertIcon, roles: ['OWNER', 'MANAGER'] },\r\n    { name: 'Incident', href: '/incidents', icon: BellAlertIcon, roles: ['OWNER', 'MANAGER', 'WORKER'] },\r\n    { name: 'Vendor', href: '/vendor', icon: BuildingStorefrontIcon, roles: ['OWNER', 'MANAGER'] },\r\n    { name: 'Audits', href: '/audits', icon: ClipboardDocumentCheckIcon, roles: ['OWNER', 'MANAGER'] },\r\n    { name: 'Offline', href: '/offline', icon: SignalIcon, roles: ['OWNER', 'MANAGER', 'WORKER'], badge: pendingCount },\r\n  ];\r\n\r\n  const filteredNav = navItems.filter((item) => item.roles.includes(role!));\r\n\r\n  const hasRouteAccessForPath = hasRouteAccess(pathname, role, ROUTE_RULES);\r\n\r\n  if (isLoading) {\r\n    return <div className=\"min-h-screen bg-background text-foreground\" />;\r\n  }\r\n\r\n  if (!isAuthenticated && !isStandaloneRoute) {\r\n    return <div className=\"min-h-screen bg-background text-foreground\" />;\r\n  }\r\n\r\n  if (isStandaloneRoute) {\r\n    return <div className=\"min-h-screen bg-background text-foreground\">{children}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex min-h-screen bg-background text-foreground\">\r\n      <aside className=\"hidden md:flex md:w-64 md:flex-col md:border-r md:bg-background/60 md:backdrop-blur-sm\">\r\n        <div className=\"p-4 border-b\">\r\n          <h1 className=\"text-lg font-bold\">FarmOps</h1>\r\n          <p className=\"text-xs text-muted-foreground uppercase\">{role} workspace</p>\r\n        </div>\r\n        <nav className=\"p-3 space-y-1 overflow-y-auto\">\r\n          {filteredNav.map((item) => (\r\n            <Link\r\n              key={item.name}\r\n              href={item.href}\r\n              className={cn(\r\n                'flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium transition-colors',\r\n                pathname === item.href ? 'bg-accent text-foreground' : 'text-muted-foreground hover:bg-accent/60'\r\n              )}\r\n            >\r\n              <div className=\"relative\">\r\n                <item.icon className=\"h-5 w-5\" />\r\n                {item.badge && item.badge > 0 && (\r\n                  <span className=\"absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-destructive text-[10px] text-destructive-foreground\">\r\n                    {item.badge}\r\n                  </span>\r\n                )}\r\n              </div>\r\n              <span>{item.name}</span>\r\n            </Link>\r\n          ))}\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => void handleLogout()}\r\n            className=\"w-full flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium transition-colors text-muted-foreground hover:bg-accent/60\"\r\n          >\r\n            <span>Logout</span>\r\n          </button>\r\n        </nav>\r\n      </aside>\r\n\r\n      <div className=\"flex-1 flex flex-col min-w-0\">\r\n      <button\r\n        onClick={() => setControlsOpen((current) => !current)}\r\n        className=\"fixed top-3 right-3 z-50 h-10 rounded-full border bg-background/90 backdrop-blur px-3 text-[10px] font-semibold uppercase md:hidden\"\r\n        aria-expanded={controlsOpen}\r\n      >\r\n        Controls\r\n      </button>\r\n\r\n      {controlsOpen ? (\r\n        <div className=\"fixed top-14 right-3 z-50 w-[min(92vw,320px)] rounded-xl border bg-background/95 backdrop-blur p-3 space-y-3 md:hidden\">\r\n          <div className=\"space-y-1\">\r\n            <p className=\"text-[10px] uppercase text-muted-foreground font-semibold\">Theme</p>\r\n            <div className=\"h-10 rounded-full border bg-background/90 p-1 flex items-center gap-1\">\r\n              {(['light', 'dark'] as const).map((themeMode) => {\r\n                const isActive = mode === themeMode;\r\n                return (\r\n                  <button\r\n                    key={themeMode}\r\n                    onClick={() => {\r\n                      setThemeMode(themeMode);\r\n                      setControlsOpen(false);\r\n                    }}\r\n                    className={cn(\r\n                      'h-8 px-2.5 rounded-full text-[10px] font-semibold uppercase transition-colors',\r\n                      isActive\r\n                        ? 'bg-primary text-primary-foreground'\r\n                        : 'text-muted-foreground hover:bg-accent'\r\n                    )}\r\n                    aria-pressed={isActive}\r\n                    title={`Set theme: ${themeMode}`}\r\n                  >\r\n                    {themeMode}\r\n                  </button>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"space-y-1\">\r\n            <p className=\"text-[10px] uppercase text-muted-foreground font-semibold\">Role</p>\r\n            <div className=\"h-10 rounded-full border bg-background/90 px-2 flex items-center gap-1\">\r\n              {(['OWNER', 'MANAGER', 'WORKER'] as const).map((r) => {\r\n                const isActive = role === r;\r\n                return (\r\n                  <button\r\n                    key={r}\r\n                    onClick={() => {\r\n                      setRole(r);\r\n                      setControlsOpen(false);\r\n                    }}\r\n                    className={cn(\r\n                      'h-8 px-2.5 rounded-full text-[10px] font-semibold uppercase transition-colors',\r\n                      isActive\r\n                        ? 'bg-primary text-primary-foreground'\r\n                        : 'text-muted-foreground hover:bg-accent'\r\n                    )}\r\n                    aria-pressed={isActive}\r\n                    title={`Switch role: ${r}`}\r\n                  >\r\n                    {r}\r\n                  </button>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => void handleLogout()}\r\n            className=\"h-10 w-full rounded-md border bg-background/90 text-[11px] font-semibold uppercase text-muted-foreground hover:bg-accent\"\r\n          >\r\n            Logout\r\n          </button>\r\n        </div>\r\n      ) : null}\r\n\r\n      <div\r\n        className=\"fixed top-3 right-3 z-50 h-10 rounded-full border bg-background/90 backdrop-blur p-1 hidden md:flex items-center gap-1\"\r\n        role=\"group\"\r\n        aria-label=\"Theme mode selector\"\r\n      >\r\n        {(['light', 'dark'] as const).map((themeMode) => {\r\n          const isActive = mode === themeMode;\r\n          return (\r\n            <button\r\n              key={themeMode}\r\n              onClick={() => setThemeMode(themeMode)}\r\n              className={cn(\r\n                'h-8 px-2.5 rounded-full text-[10px] font-semibold uppercase transition-colors',\r\n                isActive\r\n                  ? 'bg-primary text-primary-foreground'\r\n                  : 'text-muted-foreground hover:bg-accent'\r\n              )}\r\n              aria-pressed={isActive}\r\n              title={`Set theme: ${themeMode}`}\r\n            >\r\n              {themeMode}\r\n            </button>\r\n          );\r\n        })}\r\n      </div>\r\n      <div className=\"fixed top-14 right-3 z-50 h-10 rounded-full border bg-background/90 backdrop-blur px-2 hidden md:flex items-center gap-1\">\r\n        {(['OWNER', 'MANAGER', 'WORKER'] as const).map((r) => {\r\n          const isActive = role === r;\r\n          return (\r\n            <button\r\n              key={r}\r\n              onClick={() => setRole(r)}\r\n              className={cn(\r\n                'h-8 px-2.5 rounded-full text-[10px] font-semibold uppercase transition-colors',\r\n                isActive\r\n                  ? 'bg-primary text-primary-foreground'\r\n                  : 'text-muted-foreground hover:bg-accent'\r\n              )}\r\n              aria-pressed={isActive}\r\n              title={`Switch role: ${r}`}\r\n            >\r\n              {r}\r\n            </button>\r\n          );\r\n        })}\r\n      </div>\r\n      <main className=\"flex-1 pt-16 md:pt-0 pb-20 md:pb-8\">\r\n        {hasRouteAccessForPath ? (\r\n          children\r\n        ) : (\r\n          <div className=\"p-8 max-w-3xl mx-auto w-full space-y-3\">\r\n            <h1 className=\"text-xl font-bold\">Access Restricted</h1>\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              Current role does not have access to this module. Switch role from the selector in the top-right to preview authorized surfaces.\r\n            </p>\r\n          </div>\r\n        )}\r\n      </main>\r\n      \r\n      {/* Mobile Bottom Navigation */}\r\n      <nav className=\"fixed bottom-0 left-0 right-0 border-t bg-background/80 backdrop-blur-md px-2 py-2 md:hidden\">\r\n        <div className=\"pointer-events-none absolute inset-y-0 left-0 w-6 bg-gradient-to-r from-background/95 to-transparent\" />\r\n        <div className=\"pointer-events-none absolute inset-y-0 right-0 w-6 bg-gradient-to-l from-background/95 to-transparent\" />\r\n        <ul className=\"flex items-center gap-1 overflow-x-auto whitespace-nowrap no-scrollbar px-1\">\r\n          {filteredNav.map((item) => (\r\n            <li key={item.name} className=\"shrink-0\">\r\n              <Link\r\n                href={item.href}\r\n                className={cn(\r\n                  \"flex flex-col items-center gap-1 p-2 min-w-16 text-xs font-medium transition-colors\",\r\n                  pathname === item.href ? \"text-primary\" : \"text-muted-foreground\"\r\n                )}\r\n              >\r\n                <div className=\"relative\">\r\n                  <item.icon className=\"h-6 w-6\" />\r\n                  {item.badge && item.badge > 0 && (\r\n                    <span className=\"absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-destructive text-[10px] text-destructive-foreground\">\r\n                      {item.badge}\r\n                    </span>\r\n                  )}\r\n                </div>\r\n                {item.name}\r\n              </Link>\r\n            </li>\r\n          ))}\r\n          <li className=\"shrink-0\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => void handleLogout()}\r\n              className=\"flex flex-col items-center gap-1 p-2 min-w-16 text-xs font-medium transition-colors text-muted-foreground\"\r\n            >\r\n              <span className=\"h-6 w-6 inline-flex items-center justify-center\">âŽ‹</span>\r\n              Logout\r\n            </button>\r\n          </li>\r\n        </ul>\r\n      </nav>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["NavigationShell","children","role","setRole","isLoading","isAuthenticated","isRegistered","logout","mode","setThemeMode","controlsOpen","setControlsOpen","router","pathname","pendingCount","state","setPendingCount","isStandaloneRoute","handleLogout","fetch","method","replace","target","cancelled","refreshPendingCount","count","outbox","where","equals","interval","window","setInterval","clearInterval","navItems","name","href","icon","roles","badge","filteredNav","filter","item","includes","hasRouteAccessForPath","className","map","type","onClick","current","themeMode","isActive","title","r"],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA;;;AAvBA;;;;;;;;;;;AAyBO,SAASA,gBAAgB,EAAEC,QAAQ,EAAiC;;IACzE,MAAM,EAAEC,IAAI,EAAEC,OAAO,EAAEC,SAAS,EAAEC,eAAe,EAAEC,YAAY,EAAEC,MAAM,EAAE,GAAG,IAAA,8JAAO;IACnF,MAAM,EAAEC,IAAI,EAAEC,YAAY,EAAE,GAAG,IAAA,uIAAQ;IACvC,MAAM,CAACC,cAAcC,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAMC,SAAS,IAAA,kJAAS;IACxB,MAAMC,WAAW,IAAA,oJAAW;IAC5B,MAAMC,eAAe,IAAA,kJAAc;wDAAC,CAACC,QAAUA,MAAMD,YAAY;;IACjE,MAAME,kBAAkB,IAAA,kJAAc;2DAAC,CAACD,QAAUA,MAAMC,eAAe;;IACvE,MAAMC,oBAAoBJ,aAAa,eAAeA,aAAa;IAEnE,MAAMK,eAAe;QACnB,IAAI;YACF,MAAMC,MAAM,oBAAoB;gBAAEC,QAAQ;YAAO;QACnD,EAAE,OAAM,CACR;QAEAb;QACAI,gBAAgB;QAChBC,OAAOS,OAAO,CAAC;IACjB;IAEA,IAAA,0KAAS;qCAAC;YACR,IAAIjB,WAAW;YAEf,IAAI,CAACC,iBAAiB;gBACpB,IAAIY,mBAAmB;oBACrB;gBACF;gBAEA,MAAMK,SAAShB,eAAe,WAAW;gBACzC,IAAIO,aAAaS,QAAQ;oBACvBV,OAAOS,OAAO,CAACC;gBACjB;gBACA;YACF;YAEA,IAAIjB,mBAAmBY,mBAAmB;gBACxCL,OAAOS,OAAO,CAAC;YACjB;QACF;oCAAG;QAAChB;QAAiBD;QAAWE;QAAcW;QAAmBJ;QAAUD;KAAO;IAElF,IAAA,0KAAS;qCAAC;YACR,IAAIW,YAAY;YAEhB,MAAMC;iEAAsB;oBAC1B,MAAMC,QAAQ,MAAM,kIAAE,CAACC,MAAM,CAACC,KAAK,CAAC,UAAUC,MAAM,CAAC,WAAWH,KAAK;oBACrE,IAAI,CAACF,WAAW;wBACdP,gBAAgBS;oBAClB;gBACF;;YAEA,KAAKD;YACL,MAAMK,WAAWC,OAAOC,WAAW;sDAAC;oBAClC,KAAKP;gBACP;qDAAG;YAEH;6CAAO;oBACLD,YAAY;oBACZO,OAAOE,aAAa,CAACH;gBACvB;;QACF;oCAAG;QAACb;KAAgB;IAEpB,MAAMiB,WAAW;QACf;YAAEC,MAAM;YAAQC,MAAM;YAAKC,MAAM,8NAAQ;YAAEC,OAAO;gBAAC;gBAAS;gBAAW;aAAS;QAAC;QACjF;YAAEH,MAAM;YAASC,MAAM;YAAUC,MAAM,mPAAe;YAAEC,OAAO;gBAAC;gBAAW;aAAS;QAAC;QACrF;YAAEH,MAAM;YAAWC,MAAM;YAAYC,MAAM,6OAAa;YAAEC,OAAO;gBAAC;gBAAS;aAAU;QAAC;QACtF;YAAEH,MAAM;YAAWC,MAAM;YAAYC,MAAM,sPAAgB;YAAEC,OAAO;gBAAC;gBAAS;gBAAW;aAAS;QAAC;QACnG;YAAEH,MAAM;YAAUC,MAAM;YAAWC,MAAM,0OAAY;YAAEC,OAAO;gBAAC;gBAAS;aAAU;QAAC;QACnF;YAAEH,MAAM;YAAWC,MAAM;YAAgBC,MAAM,sPAAgB;YAAEC,OAAO;gBAAC;gBAAS;aAAU;QAAC;QAC7F;YAAEH,MAAM;YAAWC,MAAM;YAAYC,MAAM,gPAAc;YAAEC,OAAO;gBAAC;gBAAS;aAAU;QAAC;QACvF;YAAEH,MAAM;YAAWC,MAAM;YAAeC,MAAM,6OAAa;YAAEC,OAAO;gBAAC;gBAAS;aAAU;QAAC;QACzF;YAAEH,MAAM;YAAYC,MAAM;YAAcC,MAAM,6OAAa;YAAEC,OAAO;gBAAC;gBAAS;gBAAW;aAAS;QAAC;QACnG;YAAEH,MAAM;YAAUC,MAAM;YAAWC,MAAM,wQAAsB;YAAEC,OAAO;gBAAC;gBAAS;aAAU;QAAC;QAC7F;YAAEH,MAAM;YAAUC,MAAM;YAAWC,MAAM,oRAA0B;YAAEC,OAAO;gBAAC;gBAAS;aAAU;QAAC;QACjG;YAAEH,MAAM;YAAWC,MAAM;YAAYC,MAAM,oOAAU;YAAEC,OAAO;gBAAC;gBAAS;gBAAW;aAAS;YAAEC,OAAOxB;QAAa;KACnH;IAED,MAAMyB,cAAcN,SAASO,MAAM,CAAC,CAACC,OAASA,KAAKJ,KAAK,CAACK,QAAQ,CAACxC;IAElE,MAAMyC,wBAAwB,IAAA,mKAAc,EAAC9B,UAAUX,MAAM,gKAAW;IAExE,IAAIE,WAAW;QACb,qBAAO,6LAAC;YAAIwC,WAAU;;;;;;IACxB;IAEA,IAAI,CAACvC,mBAAmB,CAACY,mBAAmB;QAC1C,qBAAO,6LAAC;YAAI2B,WAAU;;;;;;IACxB;IAEA,IAAI3B,mBAAmB;QACrB,qBAAO,6LAAC;YAAI2B,WAAU;sBAA8C3C;;;;;;IACtE;IAEA,qBACE,6LAAC;QAAI2C,WAAU;;0BACb,6LAAC;gBAAMA,WAAU;;kCACf,6LAAC;wBAAIA,WAAU;;0CACb,6LAAC;gCAAGA,WAAU;0CAAoB;;;;;;0CAClC,6LAAC;gCAAEA,WAAU;;oCAA2C1C;oCAAK;;;;;;;;;;;;;kCAE/D,6LAAC;wBAAI0C,WAAU;;4BACZL,YAAYM,GAAG,CAAC,CAACJ,qBAChB,6LAAC,0KAAI;oCAEHN,MAAMM,KAAKN,IAAI;oCACfS,WAAW,IAAA,4HAAE,EACX,sFACA/B,aAAa4B,KAAKN,IAAI,GAAG,8BAA8B;;sDAGzD,6LAAC;4CAAIS,WAAU;;8DACb,6LAACH,KAAKL,IAAI;oDAACQ,WAAU;;;;;;gDACpBH,KAAKH,KAAK,IAAIG,KAAKH,KAAK,GAAG,mBAC1B,6LAAC;oDAAKM,WAAU;8DACbH,KAAKH,KAAK;;;;;;;;;;;;sDAIjB,6LAAC;sDAAMG,KAAKP,IAAI;;;;;;;mCAfXO,KAAKP,IAAI;;;;;0CAkBlB,6LAAC;gCACCY,MAAK;gCACLC,SAAS,IAAM,KAAK7B;gCACpB0B,WAAU;0CAEV,cAAA,6LAAC;8CAAK;;;;;;;;;;;;;;;;;;;;;;;0BAKZ,6LAAC;gBAAIA,WAAU;;kCACf,6LAAC;wBACCG,SAAS,IAAMpC,gBAAgB,CAACqC,UAAY,CAACA;wBAC7CJ,WAAU;wBACV,iBAAelC;kCAChB;;;;;;oBAIAA,6BACC,6LAAC;wBAAIkC,WAAU;;0CACb,6LAAC;gCAAIA,WAAU;;kDACb,6LAAC;wCAAEA,WAAU;kDAA4D;;;;;;kDACzE,6LAAC;wCAAIA,WAAU;kDACZ,AAAC;4CAAC;4CAAS;yCAAO,CAAWC,GAAG,CAAC,CAACI;4CACjC,MAAMC,WAAW1C,SAASyC;4CAC1B,qBACE,6LAAC;gDAECF,SAAS;oDACPtC,aAAawC;oDACbtC,gBAAgB;gDAClB;gDACAiC,WAAW,IAAA,4HAAE,EACX,iFACAM,WACI,uCACA;gDAEN,gBAAcA;gDACdC,OAAO,CAAC,WAAW,EAAEF,WAAW;0DAE/BA;+CAdIA;;;;;wCAiBX;;;;;;;;;;;;0CAIJ,6LAAC;gCAAIL,WAAU;;kDACb,6LAAC;wCAAEA,WAAU;kDAA4D;;;;;;kDACzE,6LAAC;wCAAIA,WAAU;kDACZ,AAAC;4CAAC;4CAAS;4CAAW;yCAAS,CAAWC,GAAG,CAAC,CAACO;4CAC9C,MAAMF,WAAWhD,SAASkD;4CAC1B,qBACE,6LAAC;gDAECL,SAAS;oDACP5C,QAAQiD;oDACRzC,gBAAgB;gDAClB;gDACAiC,WAAW,IAAA,4HAAE,EACX,iFACAM,WACI,uCACA;gDAEN,gBAAcA;gDACdC,OAAO,CAAC,aAAa,EAAEC,GAAG;0DAEzBA;+CAdIA;;;;;wCAiBX;;;;;;;;;;;;0CAIJ,6LAAC;gCACCN,MAAK;gCACLC,SAAS,IAAM,KAAK7B;gCACpB0B,WAAU;0CACX;;;;;;;;;;;+BAID;kCAEJ,6LAAC;wBACCA,WAAU;wBACV1C,MAAK;wBACL,cAAW;kCAEV,AAAC;4BAAC;4BAAS;yBAAO,CAAW2C,GAAG,CAAC,CAACI;4BACjC,MAAMC,WAAW1C,SAASyC;4BAC1B,qBACE,6LAAC;gCAECF,SAAS,IAAMtC,aAAawC;gCAC5BL,WAAW,IAAA,4HAAE,EACX,iFACAM,WACI,uCACA;gCAEN,gBAAcA;gCACdC,OAAO,CAAC,WAAW,EAAEF,WAAW;0CAE/BA;+BAXIA;;;;;wBAcX;;;;;;kCAEF,6LAAC;wBAAIL,WAAU;kCACZ,AAAC;4BAAC;4BAAS;4BAAW;yBAAS,CAAWC,GAAG,CAAC,CAACO;4BAC9C,MAAMF,WAAWhD,SAASkD;4BAC1B,qBACE,6LAAC;gCAECL,SAAS,IAAM5C,QAAQiD;gCACvBR,WAAW,IAAA,4HAAE,EACX,iFACAM,WACI,uCACA;gCAEN,gBAAcA;gCACdC,OAAO,CAAC,aAAa,EAAEC,GAAG;0CAEzBA;+BAXIA;;;;;wBAcX;;;;;;kCAEF,6LAAC;wBAAKR,WAAU;kCACbD,wBACC1C,yBAEA,6LAAC;4BAAI2C,WAAU;;8CACb,6LAAC;oCAAGA,WAAU;8CAAoB;;;;;;8CAClC,6LAAC;oCAAEA,WAAU;8CAAgC;;;;;;;;;;;;;;;;;kCAQnD,6LAAC;wBAAIA,WAAU;;0CACb,6LAAC;gCAAIA,WAAU;;;;;;0CACf,6LAAC;gCAAIA,WAAU;;;;;;0CACf,6LAAC;gCAAGA,WAAU;;oCACXL,YAAYM,GAAG,CAAC,CAACJ,qBAChB,6LAAC;4CAAmBG,WAAU;sDAC5B,cAAA,6LAAC,0KAAI;gDACHT,MAAMM,KAAKN,IAAI;gDACfS,WAAW,IAAA,4HAAE,EACX,uFACA/B,aAAa4B,KAAKN,IAAI,GAAG,iBAAiB;;kEAG5C,6LAAC;wDAAIS,WAAU;;0EACb,6LAACH,KAAKL,IAAI;gEAACQ,WAAU;;;;;;4DACpBH,KAAKH,KAAK,IAAIG,KAAKH,KAAK,GAAG,mBAC1B,6LAAC;gEAAKM,WAAU;0EACbH,KAAKH,KAAK;;;;;;;;;;;;oDAIhBG,KAAKP,IAAI;;;;;;;2CAhBLO,KAAKP,IAAI;;;;;kDAoBpB,6LAAC;wCAAGU,WAAU;kDACZ,cAAA,6LAAC;4CACCE,MAAK;4CACLC,SAAS,IAAM,KAAK7B;4CACpB0B,WAAU;;8DAEV,6LAAC;oDAAKA,WAAU;8DAAkD;;;;;;gDAAQ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASxF;GApTgB5C;;QAC8D,8JAAO;QACpD,uIAAQ;QAExB,kJAAS;QACP,oJAAW;QACP,kJAAc;QACX,kJAAc;;;KAPxBA"}}]
}